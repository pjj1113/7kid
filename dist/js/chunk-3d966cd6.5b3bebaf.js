(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d966cd6"],{"0090":function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"visitant-check"},[e("nav-bar",{attrs:{title:"预约审核",onlyBack:!0}}),e("div",{staticClass:"main"},[e("van-tabs",{attrs:{background:"#ffffff","title-active-color":"#333333",sticky:"","offset-top":46,"title-inactive-color":"#999999"},on:{click:t.tabClick}},t._l(t.tabs,(function(i){return e("van-tab",{key:i.id,attrs:{title:i.text+"("+(i.num<99?i.num:"99")+")"}},[e("div",{staticClass:"tab-content"},[t.checkList.length?e("div",{staticClass:"check-list"},[e("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(i){t.refreshing=i},expression:"refreshing"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了","immediate-check":!1,offset:t.offset},on:{load:t.onLoad},model:{value:t.loading,callback:function(i){t.loading=i},expression:"loading"}},t._l(t.checkList,(function(i){return e("div",{key:i.id,staticClass:"check-item"},[e("li",{on:{click:function(e){return t.centerPage(i.id)}}},[e("div",{staticClass:"check-top"},[e("div",{staticClass:"fang-name"},[e("div",{staticClass:"fang"},[t._v("访")]),e("div",{staticClass:"visitant-name"},[t._v(t._s(i.visitorName))])]),e("img",{staticClass:"check-img",attrs:{src:i.imgUrl,alt:""}}),3===i.status?e("div",{staticClass:"sare",on:{click:function(e){return e.stopPropagation(),t.toggleSare(i)}}},[e("div",{staticClass:"gantan"}),e("span",{staticClass:"text"},[t._v("安全预警")]),i.isshowSare?e("div",{staticClass:"sare-toast"},[t._v(t._s(i.visitorName)+"已被幼儿园列入安全黑名单系统将阻止他入园，请与访客确认。")]):t._e()]):t._e()]),e("div",{staticClass:"check-bottom"},[e("div",{staticClass:"peopleNum info-item"},[e("span",{staticClass:"text"},[t._v("人数：")]),t._v(t._s(i.visitorNum))]),e("div",{staticClass:"time info-item"},[e("span",{staticClass:"text"},[t._v("时间：")]),t._v(t._s(t.splitTime(i.beginTime))+"~"+t._s(t.splitTime(i.endTime)))]),e("div",{staticClass:"visitorReason info-item"},[e("span",{staticClass:"text"},[t._v("事由：")]),e("div",{staticClass:"content"},[t._v(t._s(i.visitorReason))])])]),0==i.status||3==i.status?e("div",{directives:[{name:"permission",rawName:"v-permission",value:["school-visitor-manage-application-record-audit"],expression:"['school-visitor-manage-application-record-audit']"}],staticClass:"btn-sub"},[3==t.status?e("van-button",{staticStyle:{color:"#27CBBB",borderColor:"#D5D5D5"},attrs:{round:"",plain:"",type:"info"},on:{click:function(e){return e.stopPropagation(),t.applicationRefuse(i.id)}}},[t._v("拒绝申请")]):t._e(),0==i.status?e("div",{staticClass:"btns"},[e("van-button",{staticStyle:{color:"#27CBBB",borderColor:"#D5D5D5"},attrs:{round:"",plain:"",hairline:"",block:"",type:"info"},on:{click:function(e){return e.stopPropagation(),t.applicationRefuse(i.id)}}},[t._v("拒绝申请")]),e("van-button",{attrs:{round:"",color:"linear-gradient(to right, #79DABD, #4CD7EC)",type:"button"},on:{click:function(e){return e.stopPropagation(),t.applicationAgree(i.id)}}},[t._v("同意申请")])],1):t._e()],1):t._e()])])})),0)],1)],1):e("empty-block",{attrs:{description:"啥都没有呀"}})],1)])})),1)],1)],1)},a=[],s=(e("445a"),e("72b3"),e("cca2"),e("6540"),e("b131"),e("0bd5"),e("79a8"),e("270f"),e("3f27"),e("8048")),o=e("8abc"),c=e("02aa"),r=e("da1d"),u=e("2939"),l={name:"visitant-check",data:function(){return{checkList:[],pageSize:20,pageNum:1,barHeight:"",tabs:[{id:1,text:"待审核",num:0},{id:2,text:"已审核",num:0}],userInfo:"",orgId:"",teacher:"",isSend:!1,mainTop:"",safeBottomMargin:"",loading:!1,finished:!1,refreshing:!1,offset:100,status:0,yesCheckNum:0,noCheckNum:0}},components:{EmptyBlock:c["a"],navBar:r["a"]},mounted:function(){this.userInfo=u["a"].getAppData()&&u["a"].getAppData()||"",this.userInfo.token?(this.orgId=this.userInfo.orgId,this.teacher=this.userInfo.appType):(this.$route.query.orgId&&(this.orgId=this.$route.query.orgId),this.$route.query.schoolId&&(this.orgId=this.$route.query.schoolId)),this.initGetCheckList(0,0,this.pageSize,1),this.initGetCheckList(0,1,this.pageSize,1),s["a"].setDefaultOptions({confirmButtonColor:"#48D4C6",cancelButtonColor:"#333333"})},methods:{toggleSare:function(t){this.$set(t,"isshowSare",!t.isshowSare)},centerPage:function(t){this.$router.push({name:"visitant-apply",query:{id:t}})},initCheckImg:function(){this.checkList.forEach((function(t){1===t.status?t.imgUrl=e("8699"):2===t.status&&(t.imgUrl=e("5058"))}))},getCheckList:function(t,i,e){var n=this;0===t?o["a"].getNoCheckList({pageSize:i,pageNum:e}).then((function(t){if(n.refreshing&&(n.refreshing=!1),null==t.data.list||0===t.data.list.length)return n.finished=!0,void(n.loading=!1);n.noCheckNum=t.data.total,n.$set(n.tabs[0],"num",n.noCheckNum),n.checkList=n.checkList.concat(t.data.list),n.addSare(n.checkList),n.initCheckImg(),n.loading=!1,n.visitantList&&n.visitantList.length>=t.data.total&&(n.finished=!0)})):1===t&&o["a"].getYesCheckList({pageSize:i,pageNum:e}).then((function(t){if(n.refreshing&&(n.refreshing=!1),null==t.data.list||0===t.data.list.length)return n.finished=!0,void(n.loading=!1);n.yesCheckNum=t.data.total,n.$set(n.tabs[1],"num",n.yesCheckNum),n.checkList=n.checkList.concat(t.data.list),n.addSare(n.checkList),n.initCheckImg(),n.loading=!1,n.visitantList&&n.visitantList.length>=t.data.total&&(n.finished=!0)}))},addSare:function(t){var i=this;return t.map((function(t){i.$set(t,"isshowSare",!1)}))},initGetCheckList:function(t,i,e,n){var a=this;0===i?o["a"].getNoCheckList({pageSize:e,pageNum:n}).then((function(i){0===t?(a.clearPull(),a.checkList=i.data.list,a.addSare(a.checkList),a.initCheckImg(),a.noCheckNum=i.data.total,a.$set(a.tabs[0],"num",a.noCheckNum)):(a.noCheckNum=i.data.total,a.$set(a.tabs[0],"num",a.noCheckNum))})):1===i&&o["a"].getYesCheckList({pageSize:e,pageNum:n}).then((function(i){1===t?(a.clearPull(),a.checkList=i.data.list,a.addSare(a.checkList),a.initCheckImg(),a.yesCheckNum=i.data.total,a.$set(a.tabs[1],"num",a.yesCheckNum)):(a.yesCheckNum=i.data.total,a.$set(a.tabs[1],"num",a.yesCheckNum))}))},splitTime:function(t){var i=t.split("-").slice(1);return i.join("-")},tabClick:function(t,i){var e=i.split("(")[0];"待审核"===e?(this.status=0,this.initGetCheckList(0,0,this.pageSize,1)):"已审核"===e&&(this.status=1,this.initGetCheckList(1,1,this.pageSize,1))},clearPull:function(){this.finished=!1,this.checkList=[],this.pageNum=1},onRefresh:function(){this.clearPull(),this.initGetCheckList(this.status,this.status,this.pageSize,1)},onLoad:function(){this.getCheckList(this.status,this.pageSize,++this.pageNum)},applicationRefuse:function(t){var i=this;s["a"].confirm({title:"确认拒绝申请？",message:"拒绝申请后，访客将无法进入幼儿园！"}).then((function(){o["a"].applicationRefuse({id:t}).then((function(t){i.initGetCheckList(0,0,i.pageSize,1),i.initGetCheckList(0,1,i.pageSize,1)}))})).catch((function(){}))},applicationAgree:function(t){var i=this;console.log(2435),console.log("id",t),s["a"].confirm({title:"确认同意申请？",message:"同意申请后，访客将被授权进入幼儿园！"}).then((function(){o["a"].applicationAgree({id:t}).then((function(t){i.initGetCheckList(0,0,i.pageSize,1),i.initGetCheckList(0,1,i.pageSize,1)}))})).catch((function(){}))}}},d=l,h=(e("bb15"),e("c701")),p=Object(h["a"])(d,n,a,!1,null,"6595bf02",null);i["default"]=p.exports},"02aa":function(t,i,e){"use strict";var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"empty-block"},[e("img",{style:{width:"225px"},attrs:{src:t.image}}),t._t("description",[e("div",{staticClass:"description"},[t._v(t._s(t.description))])])],2)},a=[],s={name:"empty-block",props:{image:{type:String,default:e("54e3")},description:{type:String,default:"暂无数据"}},data:function(){return{}}},o=s,c=(e("4015"),e("c701")),r=Object(c["a"])(o,n,a,!1,null,"77b72184",null);i["a"]=r.exports},"166b":function(t,i,e){},4015:function(t,i,e){"use strict";e("d11b")},5058:function(t,i,e){t.exports=e.p+"img/application_icon_refuse_b_nomal.13a4f075.png"},"54e3":function(t,i,e){t.exports=e.p+"img/icon_empty_page.a17e32dd.png"},8699:function(t,i,e){t.exports=e.p+"img/application_icon_agree_a_nomal.627d87de.png"},"8abc":function(t,i,e){"use strict";var n,a=e("28f8"),s=e("d722");i["a"]=(n={uploadFile:function(t){return Object(s["b"])("/file/v1/file/upload/binary",t,{headers:{"Content-Type":"multipart/form-data"}})},addVisitant:function(t,i){return Object(s["b"])("/visitor/v1/applicationRecord/applicationAdd",t,{headers:{"Content-Type":"application/json"}},i)},addVisitantTeacher:function(t,i){return Object(s["b"])("/visitor/v1/applicationRecord/TeacherAdd",t,{headers:{"Content-Type":"application/json"}},i)},applicationDetails:function(t){return Object(s["b"])("/visitor/v1/applicationRecord/getById",t)},applicationAgree:function(t){return Object(s["b"])("/visitor/v1/applicationRecord/agree",t)},applicationRefuse:function(t){return Object(s["b"])("/visitor/v1/applicationRecord/refuse",t)},sendSmsCode:function(t){return Object(s["b"])("/message/v1/sms/send-sms-code",t)},verifySmsCodSe:function(t){return Object(s["b"])("/message/v1/sms/verify-sms-code",t)},getSchoolInfo:function(t){return Object(s["b"])("/visitor/v1/applicationRecord/getSchoolInfo",t)},getVisitorTeacherInfo:function(t){return Object(s["b"])("/visitor/v1/applicationRecord/getTeacherInfo",t)},teacherLogin:function(t){return Object(s["b"])("/iam/v1/web-oauth/kid-login/teacher-login",t)},getVisitantDetail:function(t){return Object(s["b"])("/visitor/v1/visitor/record/get-by-id",t)}},Object(a["a"])(n,"applicationRefuse",(function(t){return Object(s["b"])("/visitor/v1/applicationRecord/refuse",t)})),Object(a["a"])(n,"applicationAgree",(function(t){return Object(s["b"])("/visitor/v1/applicationRecord/agree",t)})),Object(a["a"])(n,"delayDate",(function(t){return Object(s["b"])("/visitor/v1/visitor/record/delay-time",t)})),Object(a["a"])(n,"addAccessRecord",(function(t){return Object(s["b"])("/visitor/v1/visitor/record/add-access-record",t)})),Object(a["a"])(n,"visitantGoSchool",(function(t){return Object(s["b"])("/visitor/v1/visitor/record/entry-school",t)})),Object(a["a"])(n,"visitantOutSchool",(function(t){return Object(s["b"])("/visitor/v1/visitor/record/out-school",t)})),Object(a["a"])(n,"qrCodeInfo",(function(t){return Object(s["b"])("/visitor/v1/visitor/record/get-qr-code-info",t)})),Object(a["a"])(n,"verifyQrCode",(function(t){return Object(s["b"])("/visitor/v1/visitor/record/verify-qr-code-info",t)})),Object(a["a"])(n,"cardType",(function(t){return Object(s["b"])("/visitor/v1/option/cardType",t)})),Object(a["a"])(n,"wechatShare",(function(t){return Object(s["b"])("/visitor/v1/visitor/record/get-wechat-share-info",t)})),Object(a["a"])(n,"smsInvite",(function(t){return Object(s["b"])("/visitor/v1/visitor/record/sms-invite",t)})),Object(a["a"])(n,"applicationList",(function(t){return Object(s["b"])("/visitor/v1/applicationRecord/applicationList",t)})),Object(a["a"])(n,"getVisitantList",(function(t){return Object(s["b"])("/visitor/v1/visitor/record/query-list",t,{headers:{"Content-Type":"application/json"}})})),Object(a["a"])(n,"getCheckList",(function(t){return Object(s["b"])("/visitor/v1/applicationRecord/applicationList",t)})),Object(a["a"])(n,"getNoCheckNum",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[30];return Object(s["b"])("/visitor/v1/teacher/msg/unread",t,{headers:{"Content-Type":"application/json"}})})),Object(a["a"])(n,"getYesCheckList",(function(t){return Object(s["b"])("/visitor/v1/applicationRecord/yesApprovalList",t)})),Object(a["a"])(n,"getNoCheckList",(function(t){return Object(s["b"])("/visitor/v1/applicationRecord/noApprovalList",t)})),Object(a["a"])(n,"getCodeConfing",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])("/visitor/v1/application/backgroundConfig",t)})),n)},a7d6:function(t,i,e){"use strict";e("f257")},bb15:function(t,i,e){"use strict";e("166b")},cca2:function(t,i,e){"use strict";var n=e("a09b"),a=e("7866"),s=e("ec87"),o=e("f8b2"),c=[].join,r=a!=Object,u=o("join",",");n({target:"Array",proto:!0,forced:r||!u},{join:function(t){return c.call(s(this),void 0===t?",":t)}})},d11b:function(t,i,e){},da1d:function(t,i,e){"use strict";var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("van-nav-bar",{attrs:{title:t.t_title,fixed:"",border:t.border}},[t._t("left",[e("van-icon",{staticClass:"nav-go",attrs:{name:"arrow-left"},on:{click:t.onClickLeft}})],{slot:"left"}),t._t("title",null,{slot:"title"}),t._t("right",null,{slot:"right"})],2)},a=[],s=e("2939"),o={computed:{t_title:function(){return this.title?this.title:/.*[\u4e00-\u9fa5]+.*$/.test(this.$route.meta.title)?this.$route.meta.title:this.$t("route.".concat(this.$route.meta.title))}},props:{border:{type:Boolean,default:!0},onlyBack:{type:Boolean,default:!1},title:{type:String}},methods:{onClickLeft:function(){this.onlyBack||s["a"].closeWebview(),this.$router.go(-1)}}},c=o,r=(e("a7d6"),e("c701")),u=Object(r["a"])(c,n,a,!1,null,"2f4d49ad",null);i["a"]=u.exports},f257:function(t,i,e){}}]);