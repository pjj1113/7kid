(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e8a0c3cc"],{"0a24":function(t,e,i){t.exports=i.p+"img/icon_shibai.e8f45500.png"},"0b30":function(t,e,i){"use strict";i("554c")},"1a57":function(t,e,i){},"3a64":function(t,e,i){},5058:function(t,e,i){t.exports=i.p+"img/application_icon_refuse_b_nomal.13a4f075.png"},"554c":function(t,e,i){},"6ca3":function(t,e,i){},7836:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form-person"},[i("div",{staticClass:"visit-reason"},[t.imgUrl?i("img",{staticClass:"status",attrs:{src:t.imgUrl}}):t._e(),i("h3",[t._v("访问事由")]),i("div",{staticClass:"form-dom"},[i("van-cell-group",{attrs:{border:!1}},[i("van-cell",{attrs:{title:"访问事由",label:t.visitorReason}}),i("van-cell",{attrs:{title:"开始时间",value:t.beginTime}}),i("van-cell",{attrs:{title:"结束时间",value:t.endTime}}),i("van-cell",{attrs:{title:"接待人",value:t.receptionName}}),i("van-cell",{attrs:{title:"接待老师手机号",value:t.receptionPhone}})],1)],1)]),t._l(t.visitorVOList,(function(e,a){return i("div",{key:a,staticClass:"visit-reason visit-info"},[i("h3",[t._v("访问信息"+t._s(a+1))]),i("van-cell-group",{attrs:{border:!1}},[i("van-cell",{attrs:{title:"姓名",value:e.visitorName}}),i("van-cell",{attrs:{title:"手机号",value:e.visitorPhone}}),i("van-cell",{attrs:{title:"证件类型",value:e.cardType}}),i("van-cell",{attrs:{title:"证件号码",value:e.cardNo}})],1)],1)})),0==t.status||3==t.status?i("div",{directives:[{name:"permission",rawName:"v-permission",value:["school-visitor-manage-application-record-audit"],expression:"['school-visitor-manage-application-record-audit']"}],staticClass:"btn-sub"},[3==t.status?i("van-button",{staticStyle:{color:"#666666",borderColor:"#D5D5D5"},attrs:{round:"",plain:"",size:"large",type:"info"},on:{click:t.applicationRefuse}},[t._v("拒绝")]):t._e(),0==t.status?i("van-row",{attrs:{justify:"center"}},[i("van-col",{attrs:{span:"11"}},[i("van-button",{staticStyle:{color:"#666666",borderColor:"#D5D5D5"},attrs:{round:"",plain:"",hairline:"",block:"",type:"info"},on:{click:t.applicationRefuse}},[t._v("拒绝")])],1),i("van-col",{attrs:{span:"2"}}),i("van-col",{attrs:{span:"11"}},[i("van-button",{attrs:{round:"",size:"large",color:"linear-gradient(to right, #79DABD, #4CD7EC)",type:"button"},on:{click:t.applicationAgree}},[t._v("同意")])],1)],1):t._e()],1):t._e()],2)},n=[],o=(i("cb3c"),i("6540"),i("3f27"),i("8048")),r=(i("6a61"),i("2e91")),s=(i("ad2b"),i("2939")),c=i("8abc"),u={data:function(){return{visitorReason:"",receptionName:"",receptionPhone:"",phone:"",beginTime:"",endTime:"",visitorVOList:[],visitorName:"",status:1,imgUrl:"",cardTypeList:null,userInfo:null,id:""}},mounted:function(){s["a"].getAppData(),this.userInfo=localStorage.getItem("jsBridgeInfo")&&JSON.parse(localStorage.getItem("jsBridgeInfo"))||"",this.applicationDetails(),this.id=this.$route.query.id?this.$route.query.id:this.userInfo.id},methods:{applicationDetails:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].cardType().then((function(e){t.cardTypeList=e.data}));case 2:return e.next=4,c["a"].applicationDetails({id:t.id}).then((function(e){switch(t.visitorReason=e.data.visitorReason,t.visitorName=e.data.visitorName,t.receptionName=e.data.receptionName,t.receptionPhone=e.data.receptionPhone,t.beginTime=e.data.beginTime,t.endTime=e.data.endTime,t.visitorVOList=e.data.visitorVOList,t.visitorVOList=t.visitorVOList.map((function(e){var i=t.cardTypeList.filter((function(t){return e.cardType==t.cardType}));return e.cardType=i[0].cardTypeName,e})),t.status=e.data.status,t.status){case 0:t.imgUrl="";break;case 1:t.imgUrl=i("8699");break;case 2:t.imgUrl=i("5058");break;case 3:t.imgUrl="";break}}));case 4:case"end":return e.stop()}}),e)})))()},applicationRefuse:function(){var t=this;o["a"].confirm({title:"确认拒绝申请？",message:"拒绝申请后，访客将无法进入幼儿园！"}).then((function(){c["a"].applicationRefuse({id:t.id}).then((function(e){t.applicationDetails(),s["a"].visitorsRefreshStatus()}))})).catch((function(){}))},applicationAgree:function(){var t=this;o["a"].confirm({title:"确认同意申请？",message:"同意申请后，访客将被授权进入幼儿园！"}).then((function(){c["a"].applicationAgree({id:t.id}).then((function(e){t.applicationDetails(),s["a"].visitorsRefreshStatus()}))})).catch((function(){}))}}},l=u,h=(i("c563"),i("c701")),d=Object(h["a"])(l,a,n,!1,null,null,null);e["a"]=d.exports},8699:function(t,e,i){t.exports=i.p+"img/application_icon_agree_a_nomal.627d87de.png"},9076:function(t,e,i){"use strict";i("3a64")},"90b8":function(t,e,i){"use strict";i.r(e);var a,n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"visitant",style:t.safeBottomMargin},[a("nav-bar",{style:t.barHeight,attrs:{title:t.teacher?"访客邀请单":"访客申请单"},scopedSlots:t._u([{key:"left",fn:function(){return[a("van-icon",{attrs:{name:"arrow-left"},on:{click:t.onClickLeft}})]},proxy:!0}])}),a("div",{staticClass:"main",style:t.mainTop},[a("div",{staticClass:"user"},[a("div",{staticClass:"user-info"},[t.iconUrl?a("div",{staticClass:"logo"},[a("img",{attrs:{src:t.iconUrl}})]):t._e(),a("div",{staticClass:"title"},[a("span",[t._v(t._s(t.title))]),t.englishName?a("strong",[t._v(t._s(t.englishName))]):t._e()])]),a("div",{staticClass:"user-details"},[a("span",[t._v(t._s(t.teacher?"老师":"客人")+"您好:")]),t.teacher?a("span",[t._v("在填写邀请表时，需要您填写"),a("strong",[t._v("每位客人的信息")]),t._v("（小朋友可不填写），提交后系统将自动为每位客人生成二维码通行证！")]):a("span",[t._v("感谢您预约到访我园，请您认真填写预约表，"),a("strong",[t._v("注意每位访客信息都需要填写")]),t._v("（小朋友可不填写），提交后我们将尽快完成审核，谢谢您的配合！")])])]),a("add-person",{ref:"onSub",attrs:{numbPerson:t.num},on:{histShowFlag:t.histShowFlag,subtract:t.subtract}}),a("div",{staticClass:"footer"},[a("p",{staticClass:"footer-hint"},[t._v("上传的信息仅限用于园所审核与管理访客信息")]),t.num<10?a("div",{staticClass:"btn-add"},[a("button",{on:{click:t.addVisitant}},[a("van-icon",{attrs:{name:"plus"}}),a("span",[t._v("继续添加访客")])],1)]):t._e(),a("div",{staticClass:"btn-sub"},[a("van-button",{attrs:{round:"",size:"large",color:"linear-gradient(to right, #79DABD, #4CD7EC)",type:"button","native-type":"submit"},on:{click:t.subInfo}},[t._v("提交申请")])],1)])],1),a("van-dialog",{attrs:{"confirm-button-text":"我知道了","confirm-button-color":"#48D4C6"},on:{confirm:t.confirm},model:{value:t.hintShow,callback:function(e){t.hintShow=e},expression:"hintShow"}},[a("div",{staticClass:"hint"},[a("img",{attrs:{src:i("0a24")}}),a("p",[t._v("幼儿园无您填写的接待老师信息请确认后再提交！")])])])],1)},o=[],r=i("28f8"),s=(i("3f27"),i("8048")),c=(i("7336"),i("b08c")),u=i("da1d"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shoukuan"},[i("van-form",{ref:"pickerForm",on:{submit:t.onSubmit}},[i("div",{staticClass:"con"},[i("van-cell-group",{attrs:{border:!1}},[i("van-field",{staticClass:"rules",attrs:{readonly:"readonly",rules:[{required:!0,message:"您有必填项未填写"}],disabled:!!t.show,clearable:"",label:"开始时间","right-icon":"arrow",placeholder:"请选择"},on:{focus:t.start},model:{value:t.starttime,callback:function(e){t.starttime=e},expression:"starttime"}}),i("van-field",{staticClass:"rules",attrs:{readonly:"readonly",rules:[{required:!0,message:"您有必填项未填写"}],disabled:!!t.show1,clearable:"",label:"结束时间","right-icon":"arrow",placeholder:"请选择"},on:{focus:t.end},model:{value:t.endtime,callback:function(e){t.endtime=e},expression:"endtime"}})],1)],1),i("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("van-datetime-picker",{attrs:{type:"datetime","min-date":t.minDate,"max-date":t.maxDate,formatter:t.formatter},on:{confirm:t.confirm,cancel:t.cancel},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:t.show1,callback:function(e){t.show1=e},expression:"show1"}},[i("van-datetime-picker",{attrs:{type:"datetime","min-date":t.minDate,"max-date":t.maxDate,formatter:t.formatter},on:{confirm:t.confirm1,cancel:t.cancel1},model:{value:t.currentDate1,callback:function(e){t.currentDate1=e},expression:"currentDate1"}})],1)],1)],1)},h=[],d=(i("d0bf"),i("6a61"),i("2e91")),f=i("ad2b"),m={data:function(){return{show:!1,show1:!1,minHour:10,maxHour:20,minDate:new Date,maxDate:new Date(2020,11,31),currentDate:new Date,currentDate1:new Date,starttime:"",starttime1:"",endtime:"",endtime1:""}},mounted:function(){localStorage.getItem("visitorInfo")&&this.$route.query.orgId&&(this.starttime=JSON.parse(localStorage.getItem("visitorInfo")).teacher.beginTime,this.endtime=JSON.parse(localStorage.getItem("visitorInfo")).teacher.endTime,this.starttime1=new Date(JSON.parse(localStorage.getItem("visitorInfo")).teacher.beginTime).getTime()/1e3,this.endtime1=new Date(JSON.parse(localStorage.getItem("visitorInfo")).teacher.endTime).getTime()/1e3);var t=new Date;this.minDate=new Date(t.getFullYear(),0,1),this.maxDate=new Date(t.getFullYear(),11,31)},watch:{endtime1:function(t){this.dateRulss(t,"end")},starttime1:function(t){this.dateRulss(t,"start")}},methods:{onSubmit:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=!0,e.next=3,t.$refs.pickerForm.validate().then((function(t){i=!0})).catch((function(t){i=!1}));case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})))()},start:function(){this.show=!0},end:function(){this.show1=!0},confirm:function(){this.show=!1,this.starttime=this.currentDate.getFullYear()+"-"+(this.currentDate.getMonth()<9?"0"+(Number(this.currentDate.getMonth())+1):Number(this.currentDate.getMonth())+1)+"-"+(this.currentDate.getDate()<10?"0"+this.currentDate.getDate():this.currentDate.getDate())+" "+(this.currentDate.getHours()<10?"0"+this.currentDate.getHours():this.currentDate.getHours())+":"+(this.currentDate.getMinutes()<10?"0"+this.currentDate.getMinutes():this.currentDate.getMinutes())+":"+(this.currentDate.getSeconds()<10?"0"+this.currentDate.getSeconds():this.currentDate.getSeconds()),this.starttime1=new Date(this.currentDate).getTime()/1e3,this.$emit("getDate",["beginTime",Object(f["a"])(this.starttime1)])},cancel:function(){this.show=!1},confirm1:function(){this.show1=!1,this.endtime=this.currentDate1.getFullYear()+"-"+(this.currentDate1.getMonth()<9?"0"+(Number(this.currentDate1.getMonth())+1):Number(this.currentDate1.getMonth())+1)+"-"+(this.currentDate1.getDate()<10?"0"+this.currentDate1.getDate():this.currentDate1.getDate())+"  "+(this.currentDate1.getHours()<10?"0"+this.currentDate1.getHours():this.currentDate1.getHours())+":"+(this.currentDate1.getMinutes()<10?"0"+this.currentDate1.getMinutes():this.currentDate1.getMinutes())+":"+(this.currentDate1.getSeconds()<10?"0"+this.currentDate1.getSeconds():this.currentDate1.getSeconds()),this.endtime1=new Date(this.currentDate1).getTime()/1e3,this.$emit("getDate",["endTime",Object(f["a"])(this.endtime1)])},cancel1:function(){this.show1=!1},dateRulss:function(t,e){if(t){var i=parseInt((t-this.starttime1)/60/60/24);return i>=7&&this.starttime?(this.endtime="",this.starttime1="",void Object(c["a"])("对不起！选择的日期不能超过7天！")):this.endtime1&&this.starttime1>=this.endtime1?(this.endtime="",this.endtime1="",void Object(c["a"])("对不起！结束时间不能早于开始时间！")):void(t<(new Date).getTime()/1e3&&("end"==e?(Object(c["a"])("对不起！结束时间不能早于当前时间！"),this.endtime="",this.endtime1=""):(Object(c["a"])("对不起！开始时间不能早于当前时间！"),this.starttime="",this.starttime1="")))}},formatter:function(t,e){return"year"===t?"".concat(e,"年"):"month"===t?"".concat(e,"月"):"day"===t?"".concat(e,"日"):"hour"===t?"".concat(e,"时"):"minute"===t?"".concat(e,"分"):e}}},v=m,p=(i("0b30"),i("c701")),g=Object(p["a"])(v,l,h,!1,null,null,null),b=g.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-person"},[a("van-form",{ref:"form",staticClass:"default-rule-form",on:{submit:t.onSubmit}},[a("div",{staticClass:"visit-reason"},[a("h3",[t._v("访问事由")]),a("div",{staticClass:"form-dom"},[a("p",[a("span",[t._v("*")]),t._v(" 访问事由")]),a("van-field",{staticClass:"rules-default",attrs:{"input-align":"left",autosize:"",type:"textarea",maxlength:"200",placeholder:"请输入访问事由","show-word-limit":"",rules:[{required:!0,message:"请输入访问事由"}]},model:{value:t.formData.visitorReason,callback:function(e){t.$set(t.formData,"visitorReason",e)},expression:"formData.visitorReason"}}),a("van-cell-group",{staticStyle:{paddingLeft:"10px"},attrs:{border:!1}},[a("datetime-picker",{ref:"pickerForm",on:{getDate:t.getDate}}),a("van-field",{staticClass:"rules",attrs:{label:"接待人",rules:[{required:!0,message:"您有必填项未填写"}],placeholder:"请填写被访人姓名"},model:{value:t.formData.receptionName,callback:function(e){t.$set(t.formData,"receptionName",e)},expression:"formData.receptionName"}}),a("van-field",{staticClass:"rules",attrs:{label:"手机号",maxlength:"11",rules:[{required:!0,message:"您有必填项未填写"},{validator:t.validator,message:"手机号格式不正确"}],placeholder:"请填写被访人手机号"},on:{keyup:function(e){t.formData.receptionPhone=t.formData.receptionPhone.replace(/\D/g,"")}},model:{value:t.formData.receptionPhone,callback:function(e){t.$set(t.formData,"receptionPhone",e)},expression:"formData.receptionPhone"}})],1)],1)]),t._l(t.visitorList,(function(e,i){return a("div",{key:i,staticClass:"visit-reason visit-info"},[a("h3",[a("strong",[t._v("访问信息"+t._s(i>=1?i+1:""))]),i>=1?a("span",{on:{click:function(e){return t.delVisitor(i)}}},[t._v("删除")]):t._e()]),a("van-cell-group",{staticStyle:{paddingLeft:"10px"},attrs:{border:!1}},[a("van-field",{staticClass:"rules",attrs:{rules:[{required:!0,message:"您有必填项未填写"}],label:"访客"+(i+1)+"姓名",placeholder:"请填写真实姓名"},model:{value:e.visitorName,callback:function(i){t.$set(e,"visitorName",i)},expression:"item.visitorName"}}),a("van-field",{staticClass:"rules",attrs:{rules:[{required:!0,message:"您有必填项未填写"},{validator:t.validator,message:"手机号格式不正确"}],type:"tel",maxlength:"11",label:"手机号",placeholder:"请填写手机号"},on:{blur:function(e){return t.phoneRepeat(e,i)}},model:{value:e.visitorPhone,callback:function(i){t.$set(e,"visitorPhone",i)},expression:"item.visitorPhone"}}),t.userInfo?a("vantPicker",{attrs:{index:i},on:{getCardType:t.getCardType}}):a("vantPicker",{attrs:{index:i,cardType:e.cardType},on:{getCardType:t.getCardType}}),t.userInfo?a("van-field",{attrs:{label:"证件号码",rules:[{validator:t.carNoRules,message:"只能输入英文字母和数字"}],placeholder:"请填写证件号码"},model:{value:e.cardNo,callback:function(i){t.$set(e,"cardNo",i)},expression:"item.cardNo"}}):a("van-field",{staticClass:"rules",attrs:{label:"证件号码",rules:[{required:!0,message:"您有必填项未填写"},{validator:t.carNoRules,message:"只能输入英文字母和数字"}],placeholder:"请填写证件号码"},model:{value:e.cardNo,callback:function(i){t.$set(e,"cardNo",i)},expression:"item.cardNo"}})],1)],1)}))],2),a("van-dialog",{attrs:{showConfirmButton:!1,"close-on-click-overlay":!0,"confirm-button-color":"#48D4C6"},on:{confirm:t.confirm},model:{value:t.authCode,callback:function(e){t.authCode=e},expression:"authCode"}},[a("div",{staticClass:"auth"},[a("div",{staticClass:"auth-herder"},[a("van-icon",{attrs:{name:"arrow-left",size:"20px",color:"#D7D7D7"},on:{click:t.closeAuth}}),a("van-icon",{attrs:{name:"cross",size:"20px",color:"#D7D7D7"},on:{click:t.closeAuth}})],1),a("p",[t._v("验证码已发送至访客："+t._s(this.visitorList[0].visitorName)+" 手机号："+t._s(this.visitorList[0].visitorPhone))]),a("div",{staticClass:"authCode",on:{click:t.inputBoxFocue}},[a("div",{staticClass:"auth-code-info"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.authInfo,expression:"authInfo"}],ref:"authInput",attrs:{maxlength:"6"},domProps:{value:t.authInfo},on:{input:function(e){e.target.composing||(t.authInfo=e.target.value)}}}),t._l(t.authCodeList,(function(e,i){return a("span",{key:i,class:{authBorder:t.authBorder}},[t._v(t._s(e))])}))],2)]),a("div",{staticClass:"auth-fs"},[t.countCodeFlag?a("span",[t._v(t._s(t.countCode)+"秒后重新获取")]):a("p",{on:{click:t.anewAuth}},[a("img",{attrs:{src:i("b723")}}),t._v("点击重新获取")])])])])],1)},I=[],C=(i("72b3"),i("a543"),i("6540"),i("b131"),i("989e"),i("402f"),i("0bd5"),i("836b"),i("79a8"),i("270f"),i("d211")),w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.userInfo?i("van-field",{attrs:{label:"证件类型",readonly:"readonly",disabled:!!t.show,placeholder:"身份证","right-icon":"arrow"},on:{focus:t.getCertificate},model:{value:t.certificateValue,callback:function(e){t.certificateValue=e},expression:"certificateValue"}}):i("van-field",{staticClass:"rules",attrs:{readonly:"readonly",rules:[{required:!0,message:"您有必填项未填写"}],label:"证件类型",disabled:!!t.show,placeholder:"身份证","right-icon":"arrow"},on:{focus:t.getCertificate},model:{value:t.certificateValue,callback:function(e){t.certificateValue=e},expression:"certificateValue"}}),i("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("van-picker",{attrs:{"show-toolbar":"",title:"选择证件",columns:t.certificate},on:{cancel:t.onCancel,confirm:t.onConfirm}})],1)],1)},S=[],y=(i("cb3c"),i("8abc")),k=i("2939"),T={data:function(){return{certificate:[],certificateValue:"居民身份证",show:!1,cardNameList:null,userInfo:""}},props:["index","cardType"],mounted:function(){var t=this;k["a"].getAppData(),this.userInfo=localStorage.getItem("jsBridgeInfo")&&JSON.parse(localStorage.getItem("jsBridgeInfo"))||"",y["a"].cardType().then((function(e){t.cardNameList=e.data,t.certificate=e.data.map((function(t){return t.cardTypeName})),localStorage.getItem("visitorInfo")&&t.$route.query.orgId&&t.cardType&&e.data.forEach((function(e){e.cardType==t.cardType&&(t.certificateValue=e.cardTypeName)}))}))},methods:{onCancel:function(){this.show=!this.show},onConfirm:function(t,e){this.certificateValue=t;var i=this.cardNameList.filter((function(e){return e.cardTypeName==t}));this.$emit("getCardType",[i,this.index]),this.show=!this.show},getCertificate:function(){this.show=!this.show}}},N=T,x=(i("bcb9"),Object(p["a"])(N,w,S,!1,null,"259ff33f",null)),A=x.exports,O=(i("1a57"),{data:function(){return{formData:{receptionName:"",receptionPhone:"",beginTime:"",endTime:"",orgId:"",visitorReason:""},visitorList:[{visitorName:"",visitorPhone:"",cardType:"1",cardNo:"",sort:"1"}],userInfo:"",show:!1,subFlag:!1,authCode:!1,authCodeList:[,,,,,,],authBorder:!1,countCode:59,countCodeFlag:!0,codeInfo:"获取验证码",pattern:/\d{6}/,authInfo:"",isSubmit:!1}},props:["numbPerson"],components:{datetimePicker:b,vantPicker:A},watch:{formData:{handler:function(t,e){localStorage.setItem("visitorInfo",JSON.stringify({teacher:t,visitorList:this.visitorList,time:(new Date).getTime()}))},deep:!0},visitorList:{handler:function(t,e){localStorage.setItem("visitorInfo",JSON.stringify({teacher:this.formData,visitorList:t,time:(new Date).getTime()}))},deep:!0},numbPerson:function(t,e){t>e&&this.visitorList.push({visitorName:"",visitorPhone:"",cardType:"1",cardNo:"",sort:t.toString()})},authInfo:function(t){t.length>=6&&(this.authInfo=this.authInfo.slice(0,6),this.authCodeList=this.authInfo.split(""),this.verifySmsCodSe());for(var e=0;e<6;e++)this.authCodeList[e]=t[e]},authCode:function(t){t||(this.authInfo="")}},mounted:function(){k["a"].getAppData(),this.userInfo=localStorage.getItem("jsBridgeInfo")&&JSON.parse(localStorage.getItem("jsBridgeInfo"))||"",this.$route.query.orgId&&(this.formData.orgId=this.$route.query.orgId),this.userInfo&&(this.formData.orgId=this.userInfo.orgId),"teacher"==this.userInfo.appType?this.getVisitorTeacherInfo({teacherId:this.userInfo.teacherId}):this.$route.query.teacherId&&this.getVisitorTeacherInfo({teacherId:this.$route.query.teacherId}),localStorage.getItem("visitorInfo")&&this.$route.query.orgId&&((new Date).getTime()-JSON.parse(localStorage.getItem("visitorInfo")).time)/3e5<1&&(this.formData=JSON.parse(localStorage.getItem("visitorInfo")).teacher,JSON.parse(localStorage.getItem("visitorInfo")).visitorList&&(this.visitorList=JSON.parse(localStorage.getItem("visitorInfo")).visitorList),this.$route.query.orgId&&(this.formData.orgId=this.$route.query.orgId))},methods:{validator:function(t){return/1\d{10}/.test(t)},carNoRules:function(t){return/^[0-9a-zA-Z]*$/.test(t)},onSubmit:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=!0,e.next=3,t.$refs.form.validate().then((function(t){i=!0})).catch((function(t){i=!1}));case 3:return e.next=5,t.$refs.pickerForm.onSubmit().then((function(t){i=!(!i||!t)}));case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})))()},addVisitant:function(){var t=this;y["a"].addVisitant(Object(C["a"])(Object(C["a"])({},this.formData),{},{visitorList:this.visitorList}),!0).then((function(e){t.$router.push({path:"/visitant/applySucceed"}),t.countCode=0,window.clearInterval(trme)}),(function(e){"visitor-2001"==e.code&&t.$emit("histShowFlag")}))},addVisitantTeacher:function(){var t=this;y["a"].addVisitantTeacher(Object(C["a"])(Object(C["a"])({},this.formData),{},{visitorList:this.visitorList}),!0).then((function(t){Object(c["a"])("提交成功！"),k["a"].visitorsRefreshStatus(),k["a"].closeWebview()}),(function(e){-1!==e.message.indexOf("学校无此教师信息")&&t.$emit("histShowFlag")}))},getDate:function(t){"beginTime"===t[0]?this.formData.beginTime=t[1]:this.formData.endTime=t[1]},getCardType:function(t){this.visitorList[t[1]].cardType=t[0][0].cardType},delVisitor:function(t){this.$emit("subtract"),this.visitorList.splice(t,1)},confirm:function(){this.authCode=!1},anewAuth:function(){this.sendSmsCode()},authSubInfo:function(t){6==t.target.value.length&&this.verifySmsCodSe()},inputBoxFocue:function(){var t=this;this.authCodeList.forEach((function(e,i){if(e);else{t.$refs.authInput.focus()}}))},sendSmsCode:function(){var t=this,e=this;this.authCodeList=[,,,,,,],this.countCode<59?this.authCode=!0:y["a"].sendSmsCode({scenarioCode:"7kid,visitor.apply,code.sms.code.for.all",phoneNumbers:this.visitorList[0].visitorPhone}).then((function(i){t.authCode=!0,e.countCodeFlag=!0;var a=window.setInterval(n,1e3);function n(){e.countCode=e.countCode-1,e.countCode<1&&(window.clearInterval(a),e.countCodeFlag=!1,e.countCode=59,e.codeInfo="重新获取验证码")}}))},verifySmsCodSe:function(){var t=this;y["a"].verifySmsCodSe({smsCode:this.authInfo,phoneNumbers:this.visitorList[0].visitorPhone,scenarioCode:"7kid,visitor.apply,code.sms.code.for.all"}).then((function(e){"message-1407"==e.code?(Object(c["a"])("验证码错误，请确认后再次尝试！"),t.authBorder=!0,t.$refs.authInput.focus(),t.authCodeList=t.authCodeList.map((function(t){return""})),t.authInfo=""):(t.authCode=!1,t.userInfo.token||t.addVisitant())})).catch((function(e){t.authBorder=!0,t.authCodeList=t.authCodeList.map((function(t){return""})),t.authInfo="",t.$refs.authInput.focus()}))},closeAuth:function(){this.authCodeList=[,,,,,,],this.authBorder=!1,this.authInfo="",this.authCode=!this.authCode},getVisitorTeacherInfo:function(t){var e=this;y["a"].getVisitorTeacherInfo(t).then((function(t){e.formData.receptionName=t.data.realName,e.formData.receptionPhone=t.data.mobile}))},phoneRepeat:function(t,e){var i=this;this.visitorList.forEach((function(a,n){t.target.value==a.visitorPhone&&n<e&&(Object(c["a"])("对不起，输入的手机号重复输入，请重新输入！"),t.target.value="",i.visitorList[e].visitorPhone="")}))},onClickLeft:function(){this.$router.go(-1),k["a"].closeWebview()}}}),L=O,_=(i("9076"),Object(p["a"])(L,D,I,!1,null,null,null)),B=_.exports,J=i("7836"),j=i("f06f"),R={components:{datetimePicker:b,addPerson:B,showVisitantInfo:J["a"],recordComp:j["a"],navBar:u["a"]},data:function(){return{englishName:"",iconUrl:"",title:"",show:!1,hintShow:!1,num:1,userInfo:"",orgId:"",teacher:"",isSend:!1,statusBarHeight:"",barHeight:"",mainTop:"",safeBottomMargin:""}},mounted:function(){k["a"].getAppData(),this.userInfo=localStorage.getItem("jsBridgeInfo")&&JSON.parse(localStorage.getItem("jsBridgeInfo"))||"",this.userInfo.token?(this.orgId=this.userInfo.orgId,this.teacher=this.userInfo.appType):(this.$route.query.orgId&&(this.orgId=this.$route.query.orgId),this.$route.query.schoolId&&(this.orgId=this.$route.query.schoolId)),this.getSchoolInfo()},methods:(a={onClickLeft:function(){this.$router.go(-1),k["a"].closeWebview()},onCancel:function(){this.show=!1,Object(c["a"])("cancel")},onConfirm:function(t,e){this.certificateName=t,this.show=!this.show}},Object(r["a"])(a,"onCancel",(function(){Object(c["a"])("取消")})),Object(r["a"])(a,"getCertificate",(function(){this.show=!this.show})),Object(r["a"])(a,"addVisitant",(function(){this.num++})),Object(r["a"])(a,"subtract",(function(){this.num--})),Object(r["a"])(a,"subInfo",(function(){var t=this;this.$refs.onSub.onSubmit().then((function(e){e&&(t.userInfo.token?s["a"].confirm({title:"确认提交邀请？",message:"邀请提交后，客人将被授权进入幼儿园！",confirmButtonColor:"#48D4C6"}).then((function(){"teacher"==t.userInfo.appType&&t.$refs.onSub.addVisitantTeacher()})).catch((function(){})):t.$refs.onSub.sendSmsCode())}))})),Object(r["a"])(a,"histShowFlag",(function(){this.hintShow=!this.hintShow})),Object(r["a"])(a,"getSchoolInfo",(function(){var t=this;y["a"].getSchoolInfo({orgId:this.orgId}).then((function(e){t.englishName=e.data.englishName,t.iconUrl=e.data.iconUrl,t.title=e.data.title}))})),Object(r["a"])(a,"confirm",(function(){})),a)},M=R,P=(i("e98f"),Object(p["a"])(M,n,o,!1,null,null,null));e["default"]=P.exports},"989e":function(t,e,i){"use strict";var a=i("a09b"),n=i("0119"),o=i("0296"),r=i("c3a3"),s=i("6050"),c=i("28ea"),u=i("8863"),l=i("4d7f"),h=i("c1e5"),d=l("splice"),f=h("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,v=Math.min,p=9007199254740991,g="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!d||!f},{splice:function(t,e){var i,a,l,h,d,f,b=s(this),D=r(b.length),I=n(t,D),C=arguments.length;if(0===C?i=a=0:1===C?(i=0,a=D-I):(i=C-2,a=v(m(o(e),0),D-I)),D+i-a>p)throw TypeError(g);for(l=c(b,a),h=0;h<a;h++)d=I+h,d in b&&u(l,h,b[d]);if(l.length=a,i<a){for(h=I;h<D-a;h++)d=h+a,f=h+i,d in b?b[f]=b[d]:delete b[f];for(h=D;h>D-a+i;h--)delete b[h-1]}else if(i>a)for(h=D-a;h>I;h--)d=h+a-1,f=h+i-1,d in b?b[f]=b[d]:delete b[f];for(h=0;h<i;h++)b[h+I]=arguments[h+2];return b.length=D-a+i,l}})},b723:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPwSURBVGhD7ZlPSBRRHMetYC1wTdCDa5B7yYw0zFTytJrdKnUlSjB2gwoMFvJQgV0SizxmUHQx/EMe7KBbSF3a1kgQtD9KglqH1oN6klbHi15qvuPvJ7PuzDIzO+Puwn7gMbu/3Xnv93vv9977vd/LSJMmTfJR7rvd4Zn88td+pMBJIlX20dM0ck8Ul9nsWYcdVRU1JJJYmfw6tiVsrK3OzU+TSJWLA6/GxPddo56btSuTU2MkVsQUA465673OutpGKJ2ZnZ1DYkU219fDMCYUCPp/j7zrJ3EEe2ZAiaflTrmvtUOutLC0vLixtBzaFITw6tzCTm8XiMZliS4hukUhiSRjZgcGu8XybGtdCJNYlwGGKDx/rrE58P7PrfmZfyhN/jfTJd5rbXAf+osq8Osid8N1vMPvw99RJ/1FMgByR1VlhBuagqurs5cbbg58CMXTCN5lZVFQty3bnmOJAai4aWToByr2To2H0eP0U9xgRFAn6kYblwb7xk01YLfyWlxFL3Atdqvr3yYErQZomsQXBnqCBWJlq/MLM6OeGzXyCWcEjB6WWvq6w4FM20GMxqG8vHwoZsoqVP3gfjdWmy1BWBtuvFImrjIh+skw6F36GJPZ10MvJh4/8dFXRWIasD3JeoL4POy+elrLJqQFrDi5xcdV3TDLkX80r/RkxXD95VMkMgZcB72FrZ1EqQN6iSctJjGJUwdedTCpSJQ6YJnk3idR0rKfnhEUioEZnqGPQb8kSGIUDUDghSeiRkmQasB9UFJh8kaNgFzpeHfcvSDKgNzi7TgHcb0kSALQqWrxl+IcADiU0MeE4+p61IdlXckIVQOSiUz7tlvb6CknygAxaJP8Hkc6SZAEsC6sm5woA8wK2KxASTdFF+IJbMXBRS+sg9qiomgAb2C8IyeSIne9FIupbaoxDXDW1TRIggTiqDwj+b8uA0KBT36cwDB8WtJ7VoG2oQN0gU4kjkDRAOzAHMidbb/3VBImAG4buuiOCmA9pzpMzc9oBG1yTBbLCxRHAODw/rN/sBufq9vv7vkocJtIOxpOJCAGQfYNveDq6uwlseWgLbSJtuOOiDGJ2JXMzMapgTbYdUxzXZyLudJyX+tDEpsO6uZ2TD+Ly43AEJt52EFd7DaWKM/IjUB6HRcb9JNhUIc8VW+Z8gzmBE9sFCS/xJBD946NdzhxhoLELsc9ejB8Q4NsXam3pU2M0aUkrfzqCIch+X0YFEMyFzc0uIpyyi4zsMtiuf7+/KWh7J9hAwB8F0Ne4mlpEzebnasjLYhr+yKul36NvO2L5+wdlwFy0Mu45EPBCWr3gUgcnc+4N8MooSTzuSNNmtQhI+M/beBZ3S5w2esAAAAASUVORK5CYII="},bac7:function(t,e,i){},bcb9:function(t,e,i){"use strict";i("bac7")},c3d3:function(t,e,i){},c563:function(t,e,i){"use strict";i("6ca3")},e98f:function(t,e,i){"use strict";i("c3d3")}}]);