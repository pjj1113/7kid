(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e51d35d"],{"13e2":function(e,t,a){"use strict";a("59f3")},"59f3":function(e,t,a){},"95a6":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"record",style:e.safeBottomMargin},[i("nav-bar",{style:e.barHeight,scopedSlots:e._u([{key:"left",fn:function(){return[i("van-icon",{attrs:{name:"arrow-left"},on:{click:e.onClickLeft}})]},proxy:!0}])}),i("div",{staticClass:"main",style:e.mainTop},[i("div",{staticClass:"visit-reason"},[e._m(0),i("van-cell-group",{attrs:{border:!1}},[i("van-cell",{attrs:{title:"访问事由",label:e.visitorReason}}),i("van-cell",{attrs:{title:"开始时间",value:e.beginTime}}),i("van-cell",{attrs:{title:"结束时间",value:e.endTime}}),i("van-cell",{attrs:{title:"接待人",value:e.receptionName}}),i("van-cell",{attrs:{title:"接待老师手机号",value:e.receptionPhone}})],1),i("h3",[e._v("访问信息")]),i("van-cell-group",{attrs:{border:!1}},[i("van-cell",{attrs:{title:"姓名",value:e.visitorName}}),i("van-cell",{attrs:{title:"手机号",value:e.visitorPhone}}),i("van-cell",{attrs:{title:"证件类型",value:e.cardType}}),i("van-cell",{attrs:{title:"证件号码",value:e.cardNo}})],1),i("h3",{staticClass:"visitant-phpto"},[e._v("访客照片")]),i("div",{staticClass:"content"},[e.subFlag?i("div",{staticClass:"img-show"},[i("img",{attrs:{src:e.imageUrl}})]):i("div",{staticClass:"open-camera"},[i("van-uploader",{ref:"selectfile",attrs:{"preview-size":"170px","max-count":"1",capture:"camera","after-read":e.afterRead,multiple:""},on:{delete:e.getNewImg},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}}),e.visitantImg?e._e():i("span",[e._v("拍照留存访客现场照片")]),e.visitantImg?i("p",{on:{click:e.getImg}},[i("img",{attrs:{src:a("b723")}}),e._v("重新上传")]):e._e()],1)]),e.btnFlag?i("div",{staticClass:"btn-sub"},[i("van-button",{attrs:{round:"",size:"large",color:"linear-gradient(to right, #79DABD, #4CD7EC)",type:"button"},on:{click:e.btnSub}},[e._v("提交验证")])],1):e._e()],1)])],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("h3",[a("p",[e._v("尊敬的老师:")]),a("p",[e._v("二维码通行证是访客入园的凭证，请您认真确认访客信息，建设平安校园!")])])}],n=(a("445a"),a("cb3c"),a("7336"),a("b08c")),s=(a("6a61"),a("2e91")),o=a("28f8"),c=a("da1d"),l=(a("f06f"),a("2939")),u=a("ad2b"),d=a("8abc"),v={data:function(){var e;return e={visitantImg:"",fileList:[],imageUrl:a("b723"),visitorReason:"",receptionName:"",receptionPhone:"",beginTime:"",endTime:"",visitorName:"",visitorPhone:"",cardType:"",cardNo:"",userInfo:null,resourceId:"",btnFlag:!0,subFlag:!1,cardTypeList:"",barHeight:"",mainTop:"",statusBarHeight:"",safeBottomMargin:""},Object(o["a"])(e,"userInfo",""),Object(o["a"])(e,"id",""),e},components:{navBar:c["a"]},watch:{fileList:function(e){this.visitantImg=e[0]&&e[0].content}},mounted:function(){l["a"].getAppData(),this.userInfo=localStorage.getItem("jsBridgeInfo")&&JSON.parse(localStorage.getItem("jsBridgeInfo"))||"",this.verifyQrCode(),"iOS"==this.userInfo.deviceType&&(this.statusBarHeight=parseInt(this.userInfo.statusBarHeight),this.barHeight="height: ".concat(this.statusBarHeight+46,"px;paddingTop:").concat(this.statusBarHeight,"px"),this.mainTop="marginTop:".concat(this.statusBarHeight+46,"px"),this.safeBottomMargin="paddingBottom:".concat(parseInt(this.userInfo.safeBottomMargin),"px")),this.id=this.$route.query.id?this.$route.query.id:this.userInfo.id},methods:{verifyQrCode:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].cardType().then((function(t){e.cardTypeList=t.data}));case 2:return t.next=4,d["a"].getVisitantDetail({id:e.id}).then((function(t){e.visitorReason=t.data.visitorReason,e.receptionName=t.data.receptionName,e.receptionPhone=t.data.receptionPhone,e.beginTime=Object(u["a"])(t.data.beginTime),e.endTime=Object(u["a"])(t.data.endTime),e.visitorName=t.data.visitorName,e.visitorPhone=t.data.visitorPhone,e.cardType=t.data.cardType;var a=e.cardTypeList.filter((function(e){return t.data.cardType==e.cardType}));e.cardType=a[0].cardTypeName,e.cardNo=t.data.cardNo}));case 4:case"end":return t.stop()}}),t)})))()},afterRead:function(e){var t=this,a=new FormData;a.append("file",e.file),a.append("path","garden/"),d["a"].uploadFile(a).then((function(e){t.resourceId=e.data.id,t.imageUrl=e.data.url}))},btnSub:function(){var e=this;d["a"].addAccessRecord({id:this.id,resourceId:this.resourceId}).then((function(t){Object(n["a"])("验证成功"),e.subFlag=!e.subFlag,e.btnFlag=!1,e.userInfo.refreshToken?e.$router.go(-1):(l["a"].visitorsRefreshStatus(),l["a"].closeWebview())}))},getImg:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:document.querySelector(".van-uploader__preview-delete").click();case 1:case"end":return e.stop()}}),e)})))()},getNewImg:function(){setTimeout((function(){document.querySelector(".van-uploader__input").click()}),200)},onClickLeft:function(){this.userInfo.refreshToken?this.$router.go(-1):l["a"].closeWebview()}}},g=v,p=(a("13e2"),a("c701")),f=Object(p["a"])(g,i,r,!1,null,"a0aa3468",null);t["default"]=f.exports},b723:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPwSURBVGhD7ZlPSBRRHMetYC1wTdCDa5B7yYw0zFTytJrdKnUlSjB2gwoMFvJQgV0SizxmUHQx/EMe7KBbSF3a1kgQtD9KglqH1oN6klbHi15qvuPvJ7PuzDIzO+Puwn7gMbu/3Xnv93vv9977vd/LSJMmTfJR7rvd4Zn88td+pMBJIlX20dM0ck8Ul9nsWYcdVRU1JJJYmfw6tiVsrK3OzU+TSJWLA6/GxPddo56btSuTU2MkVsQUA465673OutpGKJ2ZnZ1DYkU219fDMCYUCPp/j7zrJ3EEe2ZAiaflTrmvtUOutLC0vLixtBzaFITw6tzCTm8XiMZliS4hukUhiSRjZgcGu8XybGtdCJNYlwGGKDx/rrE58P7PrfmZfyhN/jfTJd5rbXAf+osq8Osid8N1vMPvw99RJ/1FMgByR1VlhBuagqurs5cbbg58CMXTCN5lZVFQty3bnmOJAai4aWToByr2To2H0eP0U9xgRFAn6kYblwb7xk01YLfyWlxFL3Atdqvr3yYErQZomsQXBnqCBWJlq/MLM6OeGzXyCWcEjB6WWvq6w4FM20GMxqG8vHwoZsoqVP3gfjdWmy1BWBtuvFImrjIh+skw6F36GJPZ10MvJh4/8dFXRWIasD3JeoL4POy+elrLJqQFrDi5xcdV3TDLkX80r/RkxXD95VMkMgZcB72FrZ1EqQN6iSctJjGJUwdedTCpSJQ6YJnk3idR0rKfnhEUioEZnqGPQb8kSGIUDUDghSeiRkmQasB9UFJh8kaNgFzpeHfcvSDKgNzi7TgHcb0kSALQqWrxl+IcADiU0MeE4+p61IdlXckIVQOSiUz7tlvb6CknygAxaJP8Hkc6SZAEsC6sm5woA8wK2KxASTdFF+IJbMXBRS+sg9qiomgAb2C8IyeSIne9FIupbaoxDXDW1TRIggTiqDwj+b8uA0KBT36cwDB8WtJ7VoG2oQN0gU4kjkDRAOzAHMidbb/3VBImAG4buuiOCmA9pzpMzc9oBG1yTBbLCxRHAODw/rN/sBufq9vv7vkocJtIOxpOJCAGQfYNveDq6uwlseWgLbSJtuOOiDGJ2JXMzMapgTbYdUxzXZyLudJyX+tDEpsO6uZ2TD+Ly43AEJt52EFd7DaWKM/IjUB6HRcb9JNhUIc8VW+Z8gzmBE9sFCS/xJBD946NdzhxhoLELsc9ejB8Q4NsXam3pU2M0aUkrfzqCIch+X0YFEMyFzc0uIpyyi4zsMtiuf7+/KWh7J9hAwB8F0Ne4mlpEzebnasjLYhr+yKul36NvO2L5+wdlwFy0Mu45EPBCWr3gUgcnc+4N8MooSTzuSNNmtQhI+M/beBZ3S5w2esAAAAASUVORK5CYII="}}]);