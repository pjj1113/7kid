(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e2a2f8e"],{a680:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("nav-bar",{attrs:{onlyBack:!0,title:t.$t("wristband.modifyposition")},scopedSlots:t._u([{key:"right",fn:function(){return[i("strong",{on:{click:t.sure}},[t._v(t._s(t.$t("wristband.sure")))])]},proxy:!0}])}),i("van-field",{staticStyle:{"margin-top":"47px"},attrs:{readonly:"","input-align":"right",placeholder:t.datas.spaceName,label:t.$t("wristband.subordinatespace")}}),i("van-field",{attrs:{label:t.$t("wristband.locationname"),maxlength:"12",placeholder:t.$t("wristband.enterlocationname"),"input-align":"right"},model:{value:t.datas.name,callback:function(e){t.$set(t.datas,"name",e)},expression:"datas.name"}}),i("div",{staticStyle:{background:"white"}},[i("van-field",{attrs:{"is-link":"",readonly:"","input-align":"right",placeholder:t.$t("wristband.bindingbeacon"),label:t.$t("wristband.selectbeacon"),border:!1},on:{click:t.showDevices}}),i("div",{staticClass:"positionStyle"},t._l(t.datas.deviceExtVOList,(function(e,a){return i("div",{key:a,staticClass:"item"},[i("div",[t._v(t._s(e.deviceName))]),i("van-icon",{staticStyle:{width:"7px",height:"7px",margin:"3px 8px"},attrs:{name:"cross"},on:{click:function(i){return t.deletePos(a,e.deviceId)}}})],1)})),0)],1),i("selectBeacon",{attrs:{showSelectDevice:t.showSelectDevice,selectArray:t.datas.deviceExtVOList},on:{selectDeviceFinish:t.selectDeviceFinish,cancle:function(e){t.showSelectDevice=!1}}}),i("div",{staticStyle:{"margin-top":"10px",padding:"15px",background:"white"}},[i("div",{staticStyle:{color:"#555555","font-size":"14px"}},[t._v(t._s(t.$t("wristband.addpositiontips2")))]),i("div",{staticClass:"file-upload"},[i("uploader",{attrs:{fileList:t.fileList,maxCount:1,mediaSheetActions:t.mediaSheetActions},on:{mediaSelect:t.onMediaSelect,reUpload:t.onReUpload}})],1)])],1)},s=[],n=(i("72b3"),i("c726"),i("6540"),i("989e"),i("1d7a"),i("b784"),i("270f"),i("da1d")),o=i("a4fb"),c=i("2939"),d=i("f54c"),r=i("d9db"),l={mounted:function(){var t=this;o["a"].schoolPositionSelectById({id:this.postionId}).then((function(e){t.datas=e.data,null!=t.datas.fileInfoDTO&&t.fileList.push({url:t.datas.fileInfoDTO.url,isVideo:!1,progress:100,status:1,resourceId:t.datas.fileInfoDTO.id,id:t.datas.fileInfoDTO.id})})),window.receiveMediaDataFromNative=function(e){var i=e.parameters.data;i.forEach((function(e){var i=1==e.type,a="";a=i?e.upDataAliResponse.snapshotUrl:e.upDataAliResponse.url,console.log(a);var s=t.getExistFile(e);null!=s?(s.progress=e.progress,s.url=a,s.status=e.status,s.resourceData=e.upDataAliResponse):t.fileList.push({url:a,isVideo:i,progress:e.percent,id:e.id,path:e.path,status:e.status,resourceId:e.upDataAliResponse.id,resourceData:e.upDataAliResponse})}))},window.kidBackPress=function(){return!!t.showSelectDevice&&(t.showSelectDevice=!1,!0)}},components:{selectBeacon:d["a"],uploader:r["a"],navBar:n["a"]},data:function(){return{showSelectDevice:!1,postionId:this.$route.query.postionId,spaceId:this.$route.query.spaceId,datas:{deviceExtVOList:[]},deviceExtVOList:[],fileList:[],selectDevice:[],mediaSheetActions:[{name:this.$t("wristband.takePhoto")},{name:this.$t("wristband.fromAlbum")}]}},methods:{sure:function(){var t=this;if(""!=this.datas.name){var e=[],i="";this.fileList.length>0&&(i=this.fileList[0].resourceId),null==this.datas.deviceExtVOList||this.datas.deviceExtVOList.length<=0?this.$toast(this.$t("wristband.bindingbeacon")):(this.datas.deviceExtVOList.forEach((function(t){e.push(t.deviceId)})),o["a"].schoolPositionUpdate({id:this.postionId,name:this.datas.name,spaceId:this.spaceId,deviceIdList:e,resourceId:i}).then((function(e){t.$toast(t.$t("wristband.Operationsuccessful")),t.$router.go(-1)})))}else this.$toast(this.$t("wristband.enterlocationname"))},onClickLeft:function(){this.$router.go(-1)},selectDeviceFinish:function(t){var e=this;if(this.datas.deviceExtVOList=this.deviceExtVOList,this.deviceExtVOList.length<=0)t.forEach((function(t){var i={deviceId:t.deviceId,deviceName:t.deviceName,threshold:0};e.datas.deviceExtVOList.push(i)}));else{var i=JSON.parse(JSON.stringify(this.deviceExtVOList)),a=i.map((function(t){return t.deviceId}));t.forEach((function(t){if(!a.includes(t.deviceId)){var i={deviceId:t.deviceId,deviceName:t.deviceName,threshold:0};e.datas.deviceExtVOList.push(i)}}))}this.showSelectDevice=!1},deletePos:function(t,e){var i=this;this.$dialog.confirm({title:"",message:this.$t("wristband.editpositiontips1"),width:"270px",confirmButtonText:this.$t("wristband.sure"),confirmButtonColor:"#48D4C6",cancelButtonText:this.$t("wristband.cancel"),cancelButtonColor:"#999999"}).then((function(){i.datas.deviceExtVOList.splice(t,1)}))},showDevices:function(){this.showSelectDevice=!0,null==this.datas.deviceExtVOList&&(this.datas.deviceExtVOList=[]),this.deviceExtVOList=JSON.parse(JSON.stringify(this.datas.deviceExtVOList))},onReUpload:function(t){var e={method:"reUploadMediaFromNative",parameters:{id:t.id,path:t.path},callback:"receiveMediaDataFromeNative"};c["a"].callNative(e)},onMediaSelect:function(t){var e={method:"selectMediaDataFromNative",parameters:{},callback:"receiveMediaDataFromNative"},i=1-this.fileList.length;0==t?e.method="takePhoto":1==t&&(e.parameters={imageMaxCount:i},e.method="selectAlbum"),c["a"].callNative(e)},getExistFile:function(t){var e=null;return this.fileList.forEach((function(i){i.id==t.id&&(e=i)})),e}}},u=l,h=(i("b765"),i("c701")),v=Object(h["a"])(u,a,s,!1,null,"4b7b2784",null);e["default"]=v.exports},b765:function(t,e,i){"use strict";i("e4a8")},e4a8:function(t,e,i){}}]);